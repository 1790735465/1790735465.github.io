<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Jvm的学习 | csde`Blog</title><meta name="description" content="初始JvmJVM是Java Virtual Machine（Java虚拟机）的缩写，JVM是一种用于计算设备的规范，它是一个虚构出来的计算机，是通过在实际的计算机上仿真模拟各种计算机功能来实现的。 引入Java语言虚拟机后，Java语言在不同平台上运行时不需要重新编译。Java语言使用Java虚拟机屏蔽了与具体平台相关的信息，使得Java语言编译程序只需生成在Java虚拟机上运行的目标代码（字节码"><meta name="keywords" content="Java"><meta name="author" content="csde`Blog"><meta name="copyright" content="csde`Blog"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://hm.baidu.com"/><link rel="dns-prefetch" href="https://hm.baidu.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Jvm的学习"><meta name="twitter:description" content="初始JvmJVM是Java Virtual Machine（Java虚拟机）的缩写，JVM是一种用于计算设备的规范，它是一个虚构出来的计算机，是通过在实际的计算机上仿真模拟各种计算机功能来实现的。 引入Java语言虚拟机后，Java语言在不同平台上运行时不需要重新编译。Java语言使用Java虚拟机屏蔽了与具体平台相关的信息，使得Java语言编译程序只需生成在Java虚拟机上运行的目标代码（字节码"><meta name="twitter:image" content="https://dss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1818586636,1891100743&amp;fm=26&amp;gp=0.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Jvm的学习"><meta property="og:url" content="https://www.csde.vip/posts/4235494950/"><meta property="og:site_name" content="csde`Blog"><meta property="og:description" content="初始JvmJVM是Java Virtual Machine（Java虚拟机）的缩写，JVM是一种用于计算设备的规范，它是一个虚构出来的计算机，是通过在实际的计算机上仿真模拟各种计算机功能来实现的。 引入Java语言虚拟机后，Java语言在不同平台上运行时不需要重新编译。Java语言使用Java虚拟机屏蔽了与具体平台相关的信息，使得Java语言编译程序只需生成在Java虚拟机上运行的目标代码（字节码"><meta property="og:image" content="https://dss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1818586636,1891100743&amp;fm=26&amp;gp=0.jpg"><meta property="article:published_time" content="2020-08-18T00:39:17.000Z"><meta property="article:modified_time" content="2020-08-18T00:39:17.000Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://www.csde.vip/posts/4235494950/"><link rel="prev" title="Shell编程" href="https://www.csde.vip/posts/1661584376/"><link rel="next" title="POI及EasyExcel学习" href="https://www.csde.vip/posts/322094917/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b249631a415c6119f6f5e4ece6c4bc92";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://blog.csdn.net/weixin_45736927","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/1790735465/static/css/icon.css"><meta name="generator" content="Hexo 4.2.1"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">24</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">10</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">11</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-rocket" aria-hidden="true"></i><span> 统计</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 娱乐</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fa fa-file-movie-o"></i><span> 番剧</span></a></li><li><a class="site-page" href="/404/"><i class="fa-fw fa fa-times"></i><span> 404</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#初始Jvm"><span class="toc-number">1.</span> <span class="toc-text">初始Jvm</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Jvm的位置及体系结构"><span class="toc-number">2.</span> <span class="toc-text">Jvm的位置及体系结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#类加载器"><span class="toc-number">3.</span> <span class="toc-text">类加载器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#启动类-根-加载器-（Bootstrap-ClassLoader）"><span class="toc-number">3.1.</span> <span class="toc-text">启动类(根)加载器               （Bootstrap ClassLoader）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#扩展类记载器-（Extension-ClassLoader）"><span class="toc-number">3.2.</span> <span class="toc-text">扩展类记载器                     （Extension ClassLoader）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用程序-系统类-加载器-（Application-ClassLoader"><span class="toc-number">3.3.</span> <span class="toc-text">应用程序(系统类)加载器   （Application ClassLoader)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#双亲委派机制"><span class="toc-number">4.</span> <span class="toc-text">双亲委派机制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#测试"><span class="toc-number">4.1.</span> <span class="toc-text">测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#双亲委派机制原理"><span class="toc-number">4.2.</span> <span class="toc-text">双亲委派机制原理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#沙箱安全机制"><span class="toc-number">5.</span> <span class="toc-text">沙箱安全机制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么是沙箱？"><span class="toc-number">5.1.</span> <span class="toc-text">什么是沙箱？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java中的安全模型"><span class="toc-number">5.2.</span> <span class="toc-text">java中的安全模型?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组成沙箱的基本组件？"><span class="toc-number">5.3.</span> <span class="toc-text">组成沙箱的基本组件？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Native、方法区"><span class="toc-number">6.</span> <span class="toc-text">Native、方法区</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Native"><span class="toc-number">6.1.</span> <span class="toc-text">Native</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PC寄存器-程序计数器"><span class="toc-number">6.2.</span> <span class="toc-text">PC寄存器(程序计数器)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#方法区"><span class="toc-number">6.3.</span> <span class="toc-text">方法区</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#栈"><span class="toc-number">7.</span> <span class="toc-text">栈</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么会有栈溢出"><span class="toc-number">7.1.</span> <span class="toc-text">为什么会有栈溢出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#栈运行原理"><span class="toc-number">7.2.</span> <span class="toc-text">栈运行原理()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#堆"><span class="toc-number">8.</span> <span class="toc-text">堆</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#新生区-伊甸园区"><span class="toc-number">8.1.</span> <span class="toc-text">新生区(伊甸园区)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#伊甸园区"><span class="toc-number">8.1.1.</span> <span class="toc-text">伊甸园区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#幸存区-0，1"><span class="toc-number">8.1.2.</span> <span class="toc-text">幸存区(0，1)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#老年区"><span class="toc-number">8.2.</span> <span class="toc-text">老年区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#永久区"><span class="toc-number">8.3.</span> <span class="toc-text">永久区</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用JProfiler分析OOM异常的原因"><span class="toc-number">9.</span> <span class="toc-text">使用JProfiler分析OOM异常的原因</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装Jprofiler"><span class="toc-number">9.1.</span> <span class="toc-text">安装Jprofiler</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#idea安装Jprofiler插件"><span class="toc-number">9.1.1.</span> <span class="toc-text">idea安装Jprofiler插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装Jprofiler软件"><span class="toc-number">9.1.2.</span> <span class="toc-text">安装Jprofiler软件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用Jprofiler分析OOM异常原因"><span class="toc-number">9.2.</span> <span class="toc-text">使用Jprofiler分析OOM异常原因</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GC回收算法"><span class="toc-number">10.</span> <span class="toc-text">GC回收算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#引用计数器"><span class="toc-number">10.1.</span> <span class="toc-text">引用计数器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#复制算法"><span class="toc-number">10.2.</span> <span class="toc-text">复制算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#标记清除法"><span class="toc-number">10.3.</span> <span class="toc-text">标记清除法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#标记压缩"><span class="toc-number">10.4.</span> <span class="toc-text">标记压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">10.5.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="color"></div><div class="post-bg" id="nav" style="background-image: url(https://dss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1818586636,1891100743&amp;fm=26&amp;gp=0.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">csde`Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-rocket" aria-hidden="true"></i><span> 统计</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 娱乐</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fa fa-file-movie-o"></i><span> 番剧</span></a></li><li><a class="site-page" href="/404/"><i class="fa-fw fa fa-times"></i><span> 404</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Jvm的学习</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-08-18 08:39:17"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-08-18</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-08-18 08:39:17"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-08-18</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">5.6k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 19 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/posts/4235494950/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/posts/4235494950/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="初始Jvm"><a href="#初始Jvm" class="headerlink" title="初始Jvm"></a>初始Jvm</h1><p>JVM是Java Virtual Machine（Java<a href="https://baike.baidu.com/item/虚拟机" target="_blank" rel="noopener">虚拟机</a>）的缩写，JVM是一种用于计算设备的规范，它是一个虚构出来的计算机，是通过在实际的计算机上仿真模拟各种计算机功能来实现的。</p>
<p>引入Java语言虚拟机后，Java语言在不同平台上运行时不需要重新编译。Java语言使用Java虚拟机屏蔽了与具体平台相关的信息，使得Java语言<a href="https://baike.baidu.com/item/编译程序/8290180" target="_blank" rel="noopener">编译程序</a>只需生成在Java虚拟机上运行的目标代码（<a href="https://baike.baidu.com/item/字节码/9953683" target="_blank" rel="noopener">字节码</a>），就可以在多种平台上不加修改地运行。</p>
<p> <strong>JVM是JRE的一部分。它是一个虚构出来的计算机，是通过在实际的计算机上仿真模拟各种计算机功能来实现的。JVM有自己完善的硬件架构，如处理器、堆栈、寄存器等，还具有相应的指令系统。Java语言最重要的特点就是跨平台运行。使用JVM就是为了支持与操作系统无关，实现跨平台。所以，JAVA虚拟机JVM是属于JRE的，而现在我们安装JDK时也附带安装了JRE(当然也可以单独安装JRE)。</strong> </p>
<h1 id="Jvm的位置及体系结构"><a href="#Jvm的位置及体系结构" class="headerlink" title="Jvm的位置及体系结构"></a>Jvm的位置及体系结构</h1><p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200818101110.jpg" alt></p>
<p><strong>自己画的不太美观和不太具体,就借鉴了下百度的图片</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200818102638.png" alt></p>
<h1 id="类加载器"><a href="#类加载器" class="headerlink" title="类加载器"></a>类加载器</h1><h2 id="启动类-根-加载器-（Bootstrap-ClassLoader）"><a href="#启动类-根-加载器-（Bootstrap-ClassLoader）" class="headerlink" title="启动类(根)加载器               （Bootstrap ClassLoader）"></a>启动类(根)加载器               （Bootstrap ClassLoader）</h2><p>引导类加载器是jvm在运行时，内嵌在jvm中的一段特殊的用来加载java核心类库的C++代码。String.class 对象就是由引导类加载器加载的，引导类加载器具体加载哪些核心代码可以通过获取值为 “sun.boot.class.path” 的系统属性获得。引导类加载器不是java原生代码编写的，所以其也不是java.lang.ClassLoader类的实例，其没有getParent方法。 <strong>/jre/lib/rt.ja/java/lang</strong></p>
<h2 id="扩展类记载器-（Extension-ClassLoader）"><a href="#扩展类记载器-（Extension-ClassLoader）" class="headerlink" title="扩展类记载器                     （Extension ClassLoader）"></a>扩展类记载器                     （Extension ClassLoader）</h2><p>拓展类加载器用来加载jvm实现的一个拓展目录，该目录下的所有java类都由此类加载器加载。此路径可以通过获取”java.ext.dirs”的系统属性获得。拓展类加载器就是java.lang.ClassLoader类的一个实例，其getParent方法返回的是引导类加载器（在 HotSpot虚拟机中用null表示引导类加载)。    <strong>/jre/lib/ext</strong></p>
<h2 id="应用程序-系统类-加载器-（Application-ClassLoader"><a href="#应用程序-系统类-加载器-（Application-ClassLoader" class="headerlink" title="应用程序(系统类)加载器   （Application ClassLoader)"></a>应用程序(系统类)加载器   （Application ClassLoader)</h2><p>应用类加载器又称为系统类加载器，开发者可用通过 java.lang.ClassLoader.getSystemClassLoader()方法获得此类加载器的实例，系统类加载器也因此得名。其主要负责加载程序开发者自己编写的java类。一般来说，java应用都是用此类加载器完成加载的，可以通过获取”java.class.path”的系统属性（也就是我们常说的classpath）来获取应用类加载器加载的类路径。应用类加载器是java.lang.ClassLoader类的一个实例，其getParent方法返回的是拓展类加载器。</p>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200818113800.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//类是模板 对象是具体的</span></span><br><span class="line">       Demo02 demo1 = <span class="keyword">new</span> Demo02();</span><br><span class="line">       Demo02 demo2 = <span class="keyword">new</span> Demo02();</span><br><span class="line">       Demo02 demo3 = <span class="keyword">new</span> Demo02();</span><br><span class="line">        System.out.println(demo1.hashCode());</span><br><span class="line">        System.out.println(demo2.hashCode());</span><br><span class="line">        System.out.println(demo3.hashCode());</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends Demo02&gt; aClass1 = demo1.getClass();</span><br><span class="line">        Class&lt;? extends Demo02&gt; aClass2 = demo1.getClass();</span><br><span class="line">        Class&lt;? extends Demo02&gt; aClass3 = demo1.getClass();</span><br><span class="line">        System.out.println(aClass1.hashCode());</span><br><span class="line">        System.out.println(aClass2.hashCode());</span><br><span class="line">        System.out.println(aClass3.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line"><span class="number">1735600054</span></span><br><span class="line"><span class="number">21685669</span></span><br><span class="line"><span class="number">2133927002</span>		<span class="comment">// 一个类new出三个对象</span></span><br><span class="line"><span class="number">356573597</span></span><br><span class="line"><span class="number">356573597</span></span><br><span class="line"><span class="number">356573597</span>		<span class="comment">//但是getClass是一个类,唯一的</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Demo02 demo1 = <span class="keyword">new</span> Demo02();</span><br><span class="line">        Class&lt;? extends Demo02&gt; aClass1 = demo1.getClass();</span><br><span class="line">        ClassLoader classLoader = aClass1.getClassLoader();</span><br><span class="line">        System.out.println(classLoader);</span><br><span class="line">        ClassLoader parent = classLoader.getParent();</span><br><span class="line">        System.out.println(parent);</span><br><span class="line">        ClassLoader parent1 = parent.getParent();</span><br><span class="line">        System.out.println(parent1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sun.misc.Launcher$AppClassLoader@<span class="number">18</span>b4aac2	<span class="comment">//应用程序(系统类)加载器</span></span><br><span class="line">sun.misc.Launcher$ExtClassLoader@<span class="number">677327</span>b6	<span class="comment">//扩展类记载器</span></span><br><span class="line"><span class="keyword">null</span>										<span class="comment">//启动类(根)加载器 为null 1、为空 2、获取不到</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">类加载器的加载机制:</span><br><span class="line"></span><br><span class="line"> 双亲委托机制 当一个类加载器调用loadClass之后，并不会直接加载， 而是先交给当前类加载器的父加载器加载，直到最顶层的父加载器。 只有当父加载器无法完成加载的时候，子加载器才会尝试自己加载。</span><br><span class="line">    破坏双亲委托机制：实现热部署</span><br></pre></td></tr></table></figure>



<h1 id="双亲委派机制"><a href="#双亲委派机制" class="headerlink" title="双亲委派机制"></a>双亲委派机制</h1><p><strong>如果用户写系统自带的类,除非把JVM修改了,否则你自己写的类无法生效,为了保证安全</strong></p>
<p>  当某个类加载器需要加载某个<code>.class</code>文件时，它首先把这个任务委托给他的上级类加载器，递归这个操作，如果上级的类加载器没有加载，自己才会去加载这个类。</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.lang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s=<span class="keyword">new</span> String();</span><br><span class="line">        System.out.println(s.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">错误: 在类 java.lang.String 中找不到 main 方法, 请将 main 方法定义为:</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">否则 JavaFX 应用程序类必须扩展javafx.application.Application</span></span><br></pre></td></tr></table></figure>

<p>可以发现,我们自己写了一个String类,并且在java.lang包下,就会受到双亲委派保护.</p>
<h2 id="双亲委派机制原理"><a href="#双亲委派机制原理" class="headerlink" title="双亲委派机制原理"></a>双亲委派机制原理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在加载一个类的过程中,他会有一个向上的转移</span><br><span class="line">    <span class="number">1</span>、APP----&gt;&gt;&gt;EXC----&gt;&gt;&gt;BOOT(最终执行) </span><br><span class="line">    <span class="number">2</span>、如果BOOT加载器里面没有我们需要的类,就会找到扩展类加载器,然后应用程序加载器</span><br><span class="line">    </span><br><span class="line">   </span><br><span class="line">    <span class="number">1</span>、类加载器收到类加载的请求</span><br><span class="line">    <span class="number">2</span>、将这个请求向上委托给父类加载器去完成,一直向上进行委托,直到启动类加载器</span><br><span class="line">    <span class="number">3</span>、启动类加载器检查是否能加载当前这个类,能加载就结束,使用当前的加载器。否则抛出异常,通知子加载器进行加载</span><br></pre></td></tr></table></figure>

<h1 id="沙箱安全机制"><a href="#沙箱安全机制" class="headerlink" title="沙箱安全机制"></a>沙箱安全机制</h1><h2 id="什么是沙箱？"><a href="#什么是沙箱？" class="headerlink" title="什么是沙箱？"></a>什么是沙箱？</h2><p>Java安全模型的核心就是Java沙箱（sandbox），什么是沙箱？沙箱是一个限制程序运行的环境。沙箱机制就是将 Java 代码限定在虚拟机(JVM)特定的运行范围中，并且严格限制代码对本地系统资源访问，通过这样的措施来保证对代码的有效隔离，防止对本地系统造成破坏。沙箱<strong>主要限制系统资源访问</strong>，那系统资源包括什么？——<code>CPU、内存、文件系统、网络</code>。不同级别的沙箱对这些资源访问的限制也可以不一样。</p>
<p>  所有的Java程序运行都可以指定沙箱，可以定制安全策略。</p>
<h2 id="java中的安全模型"><a href="#java中的安全模型" class="headerlink" title="java中的安全模型?"></a>java中的安全模型?</h2><p>  在Java中将执行程序分成本地代码和远程代码两种，本地代码默认视为可信任的，而远程代码则被看作是不受信的。对于授信的本地代码，可以访问一切本地资源。而对于非授信的远程代码在早期的Java实现中，安全依赖于沙箱 (Sandbox) 机制。如下图所示 JDK1.0安全模型 </p>
<p><img src="https://img-blog.csdn.net/20181022102129401?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMwMzM2NDMz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt></p>
<p> 但如此严格的安全机制也给程序的功能扩展带来障碍，比如当用户希望远程代码访问本地系统的文件时候，就无法实现。因此在后续的 Java1.1 版本中，针对安全机制做了改进，增加了<code>安全策略</code>，允许用户指定代码对本地资源的访问权限。如下图所示 JDK1.1安全模型 </p>
<p><img src="https://img-blog.csdn.net/2018102210231938?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMwMzM2NDMz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt></p>
<p> 在 Java1.2 版本中，再次改进了安全机制，增加了<code>代码签名</code>。不论本地代码或是远程代码，都会按照用户的安全策略设定，由类加载器加载到虚拟机中权限不同的运行空间，来实现差异化的代码执行权限控制。如下图所示 JDK1.2安全模型 </p>
<p><img src="https://img-blog.csdn.net/20181022102746857?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMwMzM2NDMz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt></p>
<p> 当前最新的安全机制实现，则引入了域 (Domain) 的概念。虚拟机会把所有代码加载到不同的系统域和应用域，系统域部分专门负责与关键资源进行交互，而各个应用域部分则通过系统域的部分代理来对各种需要的资源进行访问。虚拟机中不同的受保护域 (Protected Domain)，对应不一样的权限 (Permission)。存在于不同域中的类文件就具有了当前域的全部权限，如下图所示 最新的安全模型(jdk 1.6) </p>
<p><img src="https://img-blog.csdn.net/20181022103108566?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMwMzM2NDMz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt></p>
<p> 以上提到的都是基本的<code>Java 安全模型概念</code>，在应用开发中还有一些<code>关于安全的复杂用法</code>，其中最常用到的 API 就是 doPrivileged。<code>doPrivileged 方法能够使一段受信任代码获得更大的权限，甚至比调用它的应用程序还要多，可做到临时访问更多的资源</code>。有时候这是非常必要的，可以应付一些特殊的应用场景。例如，应用程序可能无法直接访问某些系统资源，但这样的应用程序必须得到这些资源才能够完成功能。 </p>
<h2 id="组成沙箱的基本组件？"><a href="#组成沙箱的基本组件？" class="headerlink" title="组成沙箱的基本组件？"></a>组成沙箱的基本组件？</h2><ul>
<li><code>字节码校验器</code>（bytecode verifier）：确保Java类文件遵循Java语言规范。这样可以帮助Java程序实现内存保护。但并不是所有的类文件都会经过字节码校验，比如核心类。</li>
<li>类装载器（class loader）：其中类装载器在3个方面对Java沙箱起作用<ul>
<li>它防止恶意代码去干涉善意的代码；</li>
<li>它守护了被信任的类库边界；</li>
<li>它将代码归入保护域，确定了代码可以进行哪些操作。</li>
</ul>
</li>
</ul>
<p>  虚拟机为不同的类加载器载入的类提供不同的命名空间，命名空间由一系列唯一的名称组成，每一个被装载的类将有一个名字，这个命名空间是由Java虚拟机为每一个类装载器维护的，它们互相之间甚至不可见。</p>
<p>  类装载器采用的机制是双亲委派模式。</p>
<ol>
<li>从最内层JVM自带类加载器开始加载，外层恶意同名类得不到加载从而无法使用；</li>
<li>由于严格通过包来区分了访问域，外层恶意的类通过内置代码也无法获得权限访问到内层类，破坏代码就自然无法生效。</li>
</ol>
<ul>
<li><code>存取控制器</code>（access controller）：存取控制器可以控制核心API对操作系统的存取权限，而这个控制的策略设定，可以由用户指定。</li>
<li><code>安全管理器</code>（security manager）：是核心API和操作系统之间的主要接口。实现权限控制，比存取控制器优先级高。</li>
<li>安全软件包（security package）：java.security下的类和扩展包下的类，允许用户为自己的应用增加新的安全特性，包括：<ul>
<li>安全提供者</li>
<li>消息摘要</li>
<li>数字签名</li>
<li>加密</li>
<li>鉴别</li>
</ul>
</li>
</ul>
<h1 id="Native、方法区"><a href="#Native、方法区" class="headerlink" title="Native、方法区"></a>Native、方法区</h1><h2 id="Native"><a href="#Native" class="headerlink" title="Native"></a>Native</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">一旦出现了Native关键字的话,说明Java的作用范围无法达到,需要调用底层的C语言的库</span><br><span class="line"></span><br><span class="line">在前面的Jvm体系结构也可以看到,有一个本地方法栈,一旦使用到Native关键字,就会启动本地方法栈,进而调用本地方法接口(JNI),调用本地方法库</span><br><span class="line"></span><br><span class="line">本地方法接口(JNI)的作用:控制Java的使用,融合不同的变成语言为Java所用!!</span><br><span class="line"></span><br><span class="line">Java诞生的时候并不是太出名,当时的C、C++横向,Java想要立足于编程语言,就必须遵守C、C++的规范</span><br><span class="line"></span><br><span class="line">于是Java在内存开辟一块标记区域(本地方法栈):注册Native方法,在最终执行的时候,加载本地方法库中的方法通过JNI调用</span><br><span class="line">    </span><br><span class="line">Native关键字一般是Java去操作一些硬件才会使用到,一般在企业开发中,较为少见.</span><br></pre></td></tr></table></figure>

<h2 id="PC寄存器-程序计数器"><a href="#PC寄存器-程序计数器" class="headerlink" title="PC寄存器(程序计数器)"></a>PC寄存器(程序计数器)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">每个线程都有一个程序计数器，是线程私有的，就是一个指针， </span><br><span class="line">指向方法区中的方法字节码(用来存储指向像一条指令的地址， 也即将要执行的指令代码) , </span><br><span class="line">在执行引擎读取下一条指令, 是一个非常小的内存空间，几乎可以忽略不计</span><br></pre></td></tr></table></figure>

<h2 id="方法区"><a href="#方法区" class="headerlink" title="方法区"></a>方法区</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">方法区是被所有线程共享，所有字段和方法字节码，以及一些特殊方法，如构造函数，接口代码也在此定义,</span><br><span class="line">简单说，所有定义的方法的信息都保存在该区域，此区域属于共享区间;</span><br><span class="line"></span><br><span class="line">静态变量(<span class="keyword">static</span>)、常量(<span class="keyword">final</span>)、类(Class)信息(构造方法、接口定义)、运行时的常量池存在方法区中，但是实例变量存在堆内存</span><br><span class="line">中，和方法区无关</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200818165654.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Text</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">private</span> String  name=<span class="string">"zhangsan"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Text text = <span class="keyword">new</span> Text();</span><br><span class="line">        text.name=<span class="string">"123"</span>;	<span class="comment">//如果给他重新赋值,堆里面的name就变成了123</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h1><p><strong>提到栈自然会想到队列,一般用栈和队列进行比较</strong></p>
<p><strong>栈的特点:先进后出,后进先出</strong></p>
<p><code>喝多了吐就是栈</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819093709.png" alt></p>
<p><strong>队列的特点:先进先出,后进后出</strong></p>
<p><code>吃多了拉就是队列</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819093827.png" alt></p>
<p> 每当启动一个新线程时，Java虚拟机都会为它分配一个Java栈。Java栈以帧为单位保存线程的运行状态。虚拟机只会直接对Java栈执行两种操作：以帧为单位的压栈和出栈。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">栈:栈内存,主管程序的运行,生命周期和线程同步;</span><br><span class="line">线程结束，意味着栈内存释放,所以栈内存没有垃圾;</span><br><span class="line"></span><br><span class="line">栈存的是什么: <span class="number">8</span>大基本类型+引用类型+实例的方法</span><br></pre></td></tr></table></figure>

<h2 id="为什么会有栈溢出"><a href="#为什么会有栈溢出" class="headerlink" title="为什么会有栈溢出"></a>为什么会有栈溢出</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Demo02().a();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">()</span></span>&#123;</span><br><span class="line">        b();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">b</span><span class="params">()</span></span>&#123;</span><br><span class="line">        a();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">以上的代码就是出现 java.lang.StackOverflowError 异常</span><br><span class="line"></span><br><span class="line">为什么会出现这样的情况了,因为a和b相互调用,一直进行压栈,无法进行出来。</span><br></pre></td></tr></table></figure>

<h2 id="栈运行原理"><a href="#栈运行原理" class="headerlink" title="栈运行原理()"></a>栈运行原理()</h2><p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819095809.png" alt></p>
<h1 id="堆"><a href="#堆" class="headerlink" title="堆"></a>堆</h1><p> <strong>java堆在虚拟机启动的时候建立，它是java程序最主要的内存工作区域。几乎所有的java对象实例都存放在java堆中。堆空间是所有线程共享的，这是一块与java应用密切相关的内存空间。</strong> </p>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819102752.png" alt></p>
<p>在JDK1.8版本废弃了永久代，替代的是元空间（MetaSpace），元空间与永久代上类似，都是方法区的实现，他们最大区别是：元空间并不在JVM中，而是使用本地内存。<br>元空间有注意有两个参数：</p>
<ul>
<li><p>MetaspaceSize ：初始化元空间大小，控制发生GC阈值</p>
</li>
<li><p>MaxMetaspaceSize ： 限制元空间大小上限，防止异常占用过多物理内存</p>
</li>
</ul>
<p><strong>GC垃圾回收主要在新生区和老年区</strong></p>
<p><strong>如果堆内容满之后,就会出现OOM异常</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String name=<span class="string">"csdecsdecsdecsdecsde"</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">            name+=name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exception in thread <span class="string">"main"</span> java.lang.OutOfMemoryError: Java heap space  <span class="comment">//堆内存爆满了</span></span><br></pre></td></tr></table></figure>



<p><strong>堆内容细分的三个区域</strong></p>
<h2 id="新生区-伊甸园区"><a href="#新生区-伊甸园区" class="headerlink" title="新生区(伊甸园区)"></a>新生区(伊甸园区)</h2><ul>
<li>类诞生和生长的地方 ,甚至死亡</li>
</ul>
<h3 id="伊甸园区"><a href="#伊甸园区" class="headerlink" title="伊甸园区"></a>伊甸园区</h3><p><strong>所有的对象都是在伊甸园区 new 出来的,经过几次轻GC的清理,存活到幸存区;</strong></p>
<h3 id="幸存区-0，1"><a href="#幸存区-0，1" class="headerlink" title="幸存区(0，1)"></a><strong>幸存区(0，1)</strong></h3><p><strong>幸存区0区和幸存区1区是动态交互的过程,当幸存区满之后,触发轻GC,把存活送到到永久区</strong></p>
<h2 id="老年区"><a href="#老年区" class="headerlink" title="老年区"></a>老年区</h2><p>老年代主要存放应用中生命周期长的内存对象。老年代比较稳定，不会频繁的进行MajorGC。而在MaiorGC之前才会先进行一次MinorGc，使得新生的对象进入老年代而导致空间不够才会触发。当无法找到足够大的连续空间分配给新创建的较大对象也会提前触发一次MajorGC进行垃圾回收腾出空间。</p>
<p>　　在老年代中，MajorGC采用了标记—清除算法：首先扫描一次所有老年代里的对象，标记出存活的对象，然后回收没有标记的对象。MajorGC的耗时比较长。因为要扫描再回收。MajorGC会产生内存碎片，当老年代也没有内存分配给新来的对象的时候，就会抛出OOM（Out of Memory）异常。</p>
<h2 id="永久区"><a href="#永久区" class="headerlink" title="永久区"></a>永久区</h2><p><strong>这个区域是常驻内存的。用来存放jdk自身携带的Class对象。Interface元数据,存储的是Java运行的环境和类信息,这个地方不存在垃圾回收</strong></p>
<ul>
<li>jdk1.6之前    :永久代，常量池在方法区中</li>
<li>jdk1.7            :永久代,但是慢慢的退化了,提出了<code>去永久代</code>,常量池在堆中</li>
<li>jdk1.8之后     :无永久代,变成元空间(非堆)。常量池在元空间</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819112939.png" alt></p>
<p><strong>元空间在逻辑上存在,物理上是不在的</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回jvm使用的最大内存</span></span><br><span class="line"><span class="keyword">long</span> max = Runtime.getRuntime().maxMemory();</span><br><span class="line"><span class="comment">//返回jvm初始化内容</span></span><br><span class="line"><span class="keyword">long</span> total = Runtime.getRuntime().totalMemory();</span><br><span class="line"></span><br><span class="line">System.out.println(max+<span class="string">"字节\t"</span>+max/<span class="number">1024</span>/<span class="number">1024</span>+<span class="string">"MB"</span>); 		<span class="number">1886912512</span>字节	<span class="number">1799</span>MB</span><br><span class="line">System.out.println(total+<span class="string">"字节\t"</span>+total/<span class="number">1024</span>/<span class="number">1024</span>+<span class="string">"MB"</span>);	<span class="number">128974848</span>字节		<span class="number">123</span>MB</span><br><span class="line"></span><br><span class="line"><span class="comment">//电脑内存为8G </span></span><br><span class="line"><span class="comment">//默认情况下 jvm最大内存是电脑内存的1/4 初始化内存的1/64,</span></span><br></pre></td></tr></table></figure>

<p>我们修改默认的参数,如下图</p>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819113825.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">参数: -Xmx1024m -Xms512m -XX:+PrintGCDetails		<span class="comment">//最大内存1024 初始化内存 512 打印出详细信息</span></span><br><span class="line">    	</span><br><span class="line">   </span><br><span class="line">        <span class="keyword">long</span> max = Runtime.getRuntime().maxMemory(); 		<span class="number">954728448</span>字节	<span class="number">910</span>MB</span><br><span class="line">        <span class="keyword">long</span> total = Runtime.getRuntime().totalMemory();	<span class="number">514850816</span>字节	<span class="number">491</span>MB</span><br><span class="line"></span><br><span class="line">        System.out.println(max+<span class="string">"字节\t"</span>+max/<span class="number">1024</span>/<span class="number">1024</span>+<span class="string">"MB"</span>);</span><br><span class="line">        System.out.println(total+<span class="string">"字节\t"</span>+total/<span class="number">1024</span>/<span class="number">1024</span>+<span class="string">"MB"</span>);</span><br><span class="line"></span><br><span class="line">PSYoungGen(新生区)+ParOldGen(养老区)=<span class="number">153088</span>K+<span class="number">349696</span>K=<span class="number">491</span>MB <span class="comment">//这就是说元空间逻辑上存在,物理上不存在</span></span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">Heap</span><br><span class="line"> PSYoungGen      total <span class="number">153088</span>K, used <span class="number">10527</span>K [<span class="number">0x00000000eab00000</span>, <span class="number">0x00000000f5580000</span>, <span class="number">0x0000000100000000</span>)</span><br><span class="line">  eden space <span class="number">131584</span>K, <span class="number">8</span>% used [<span class="number">0x00000000eab00000</span>,<span class="number">0x00000000eb547c98</span>,<span class="number">0x00000000f2b80000</span>)</span><br><span class="line">  from space <span class="number">21504</span>K, <span class="number">0</span>% used [<span class="number">0x00000000f4080000</span>,<span class="number">0x00000000f4080000</span>,<span class="number">0x00000000f5580000</span>)</span><br><span class="line">  to   space <span class="number">21504</span>K, <span class="number">0</span>% used [<span class="number">0x00000000f2b80000</span>,<span class="number">0x00000000f2b80000</span>,<span class="number">0x00000000f4080000</span>)</span><br><span class="line">                              </span><br><span class="line"> ParOldGen       total <span class="number">349696</span>K, used <span class="number">0</span>K [<span class="number">0x00000000c0000000</span>, <span class="number">0x00000000d5580000</span>, <span class="number">0x00000000eab00000</span>)</span><br><span class="line">  object space <span class="number">349696</span>K, <span class="number">0</span>% used [<span class="number">0x00000000c0000000</span>,<span class="number">0x00000000c0000000</span>,<span class="number">0x00000000d5580000</span>)</span><br><span class="line">                                 </span><br><span class="line"> Metaspace       used <span class="number">3215</span>K, capacity <span class="number">4496</span>K, committed <span class="number">4864</span>K, reserved <span class="number">1056768</span>K</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">space</span>    <span class="title">used</span> 349<span class="title">K</span>, <span class="title">capacity</span> 388<span class="title">K</span>, <span class="title">committed</span> 512<span class="title">K</span>, <span class="title">reserved</span> 1048576<span class="title">K</span></span></span><br></pre></td></tr></table></figure>

<p><strong>OOM异常</strong></p>
<p>解决方案: 1、尝试扩大堆内存看结果    </p>
<p>​                 2、分析内存，看一下那个地方出现了问题(专业工具)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">参数: -Xmx8m -Xms8m -XX:+PrintGCDetails</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">            String name=<span class="string">"csdecsdecsdecsdecsde"</span>;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">                name+=name;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//代码一直产生新的对象,GC一直触发,直到垃圾对象无法被GC清除,沾满了内存空间,爆出OOM异常</span></span><br><span class="line">[GC (Allocation Failure) [PSYoungGen: <span class="number">1536</span>K-&gt;<span class="number">488</span>K(<span class="number">2048</span>K)] <span class="number">1536</span>K-&gt;<span class="number">632</span>K(<span class="number">7680</span>K), <span class="number">0.0021969</span> secs] [Times: user=<span class="number">0.00</span> sys=<span class="number">0.02</span>, real=<span class="number">0.00</span> secs] </span><br><span class="line">[GC (Allocation Failure) [PSYoungGen: <span class="number">1890</span>K-&gt;<span class="number">488</span>K(<span class="number">2048</span>K)] <span class="number">2034</span>K-&gt;<span class="number">1128</span>K(<span class="number">7680</span>K), <span class="number">0.0011846</span> secs] [Times: user=<span class="number">0.00</span> sys=<span class="number">0.00</span>, real=<span class="number">0.00</span> secs] </span><br><span class="line">[GC (Allocation Failure) [PSYoungGen: <span class="number">1831</span>K-&gt;<span class="number">504</span>K(<span class="number">2048</span>K)] <span class="number">2471</span>K-&gt;<span class="number">2112</span>K(<span class="number">7680</span>K), <span class="number">0.0009461</span> secs] [Times: user=<span class="number">0.00</span> sys=<span class="number">0.00</span>, real=<span class="number">0.00</span> secs] </span><br><span class="line">[<span class="function">Full <span class="title">GC</span> <span class="params">(Ergonomics)</span> [PSYoungGen: 1845K-&gt;0<span class="title">K</span><span class="params">(<span class="number">2048</span>K)</span>] [ParOldGen: 5448K-&gt;3159<span class="title">K</span><span class="params">(<span class="number">5632</span>K)</span>] 7293K-&gt;3159<span class="title">K</span><span class="params">(<span class="number">7680</span>K)</span>, [Metaspace: 3198K-&gt;3198<span class="title">K</span><span class="params">(<span class="number">1056768</span>K)</span>], 0.0070464 secs] [Times: user</span>=<span class="number">0.02</span> sys=<span class="number">0.00</span>, real=<span class="number">0.01</span> secs] </span><br><span class="line">[GC (Allocation Failure) [PSYoungGen: <span class="number">0</span>K-&gt;<span class="number">0</span>K(<span class="number">2048</span>K)] <span class="number">3159</span>K-&gt;<span class="number">3159</span>K(<span class="number">7680</span>K), <span class="number">0.0003762</span> secs] [Times: user=<span class="number">0.00</span> sys=<span class="number">0.00</span>, real=<span class="number">0.00</span> secs] </span><br><span class="line">[<span class="function">Full <span class="title">GC</span> <span class="params">(Allocation Failure)</span> [PSYoungGen: 0K-&gt;0<span class="title">K</span><span class="params">(<span class="number">2048</span>K)</span>] [ParOldGen: 3159K-&gt;3141<span class="title">K</span><span class="params">(<span class="number">5632</span>K)</span>] 3159K-&gt;3141<span class="title">K</span><span class="params">(<span class="number">7680</span>K)</span>, [Metaspace: 3198K-&gt;3198<span class="title">K</span><span class="params">(<span class="number">1056768</span>K)</span>], 0.0071967 secs] [Times: user</span>=<span class="number">0.00</span> sys=<span class="number">0.00</span>, real=<span class="number">0.01</span> secs] </span><br><span class="line">Heap</span><br><span class="line"> PSYoungGen      total <span class="number">2048</span>K, used <span class="number">108</span>K [<span class="number">0x00000000ffd80000</span>, <span class="number">0x0000000100000000</span>, <span class="number">0x0000000100000000</span>)</span><br><span class="line">  eden space <span class="number">1536</span>K, <span class="number">7</span>% used [<span class="number">0x00000000ffd80000</span>,<span class="number">0x00000000ffd9b038</span>,<span class="number">0x00000000fff00000</span>)</span><br><span class="line">  from space <span class="number">512</span>K, <span class="number">0</span>% used [<span class="number">0x00000000fff80000</span>,<span class="number">0x00000000fff80000</span>,<span class="number">0x0000000100000000</span>)</span><br><span class="line">  to   space <span class="number">512</span>K, <span class="number">0</span>% used [<span class="number">0x00000000fff00000</span>,<span class="number">0x00000000fff00000</span>,<span class="number">0x00000000fff80000</span>)</span><br><span class="line"> ParOldGen       total <span class="number">5632</span>K, used <span class="number">3141</span>K [<span class="number">0x00000000ff800000</span>, <span class="number">0x00000000ffd80000</span>, <span class="number">0x00000000ffd80000</span>)</span><br><span class="line">  object space <span class="number">5632</span>K, <span class="number">55</span>% used [<span class="number">0x00000000ff800000</span>,<span class="number">0x00000000ffb116e0</span>,<span class="number">0x00000000ffd80000</span>)</span><br><span class="line"> Metaspace       used <span class="number">3242</span>K, capacity <span class="number">4496</span>K, committed <span class="number">4864</span>K, reserved <span class="number">1056768</span>K</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">space</span>    <span class="title">used</span> 352<span class="title">K</span>, <span class="title">capacity</span> 388<span class="title">K</span>, <span class="title">committed</span> 512<span class="title">K</span>, <span class="title">reserved</span> 1048576<span class="title">K</span></span></span><br><span class="line">Exception in thread "main" java.lang.OutOfMemoryError: Java heap space</span><br><span class="line">	at java.util.Arrays.copyOf(Arrays.java:<span class="number">3332</span>)</span><br><span class="line">	at java.lang.AbstractStringBuilder.ensureCapacityInternal(AbstractStringBuilder.java:<span class="number">124</span>)</span><br><span class="line">	at java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:<span class="number">448</span>)</span><br><span class="line">	at java.lang.StringBuilder.append(StringBuilder.java:<span class="number">136</span>)</span><br><span class="line">	at com.csde.Demo.Demo02.main(Demo02.java:<span class="number">9</span>)</span><br></pre></td></tr></table></figure>

<h1 id="使用JProfiler分析OOM异常的原因"><a href="#使用JProfiler分析OOM异常的原因" class="headerlink" title="使用JProfiler分析OOM异常的原因"></a>使用JProfiler分析OOM异常的原因</h1><p>在一个项目中,突然出现了OOM异常,我们应该如果解决.在前面我们已经提到过,<code>首先扩大jvm的内存</code>。如果还是不能解决,就通过<code>JProfiler进行分析</code></p>
<ul>
<li>能够看到第几行代码出错: 内存快照分析工具 eclipse(MAT) Jprofiler</li>
</ul>
<p>MAT，Jpofiler的作用</p>
<ul>
<li>分析Dump下来的文件,快速定位内存泄漏问题</li>
<li>获得堆中的数据</li>
<li>获得大的对象</li>
<li>….</li>
</ul>
<h2 id="安装Jprofiler"><a href="#安装Jprofiler" class="headerlink" title="安装Jprofiler"></a>安装Jprofiler</h2><h3 id="idea安装Jprofiler插件"><a href="#idea安装Jprofiler插件" class="headerlink" title="idea安装Jprofiler插件"></a>idea安装Jprofiler插件</h3><p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819144746.png" alt></p>
<p><code>安装完以后重启,状态栏上面就会出现jprofiler的一个logo</code></p>
<h3 id="安装Jprofiler软件"><a href="#安装Jprofiler软件" class="headerlink" title="安装Jprofiler软件"></a>安装Jprofiler软件</h3><p>下载地址》》》》 <a href="https://www.ej-technologies.com/download/jprofiler/files" target="_blank" rel="noopener">https://www.ej-technologies.com/download/jprofiler/files</a> </p>
<p>安装过程不在简绍;安装完成之后再idea引入jprofiler</p>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819145146.png" alt></p>
<h2 id="使用Jprofiler分析OOM异常原因"><a href="#使用Jprofiler分析OOM异常原因" class="headerlink" title="使用Jprofiler分析OOM异常原因"></a>使用Jprofiler分析OOM异常原因</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">参数: -Xmx8m -Xms8m -XX:+HeapDumpOnOutOfMemoryError</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="keyword">byte</span>[]  bytes =  <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;Demo02&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;Demo02&gt;();</span><br><span class="line">        <span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">                arrayList.add(<span class="keyword">new</span> Demo02());</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Error e)&#123;</span><br><span class="line">            System.out.println(<span class="string">"运行"</span>+count+<span class="string">"次,出现OOM异常"</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">java.lang.OutOfMemoryError: Java heap space</span><br><span class="line">Dumping heap to java_pid11008.hprof ...		<span class="comment">//已经生成了jprofiler文件,后缀名为hprof,位置在父目录</span></span><br><span class="line">Heap dump file created [<span class="number">7739550</span> bytes in <span class="number">0.016</span> secs]</span><br><span class="line">运行<span class="number">6</span>次,出现OOM异常</span><br><span class="line">java.lang.OutOfMemoryError: Java heap space</span><br><span class="line">	at com.csde.Demo.Demo02.&lt;init&gt;(Demo02.java:<span class="number">8</span>)</span><br><span class="line">	at com.csde.Demo.Demo02.main(Demo02.java:<span class="number">14</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819152450.png" alt></p>
<p>打开之后,就会出现一些类的具体信息,重图中可以看到,char[]这个数组 占的内存非常大.</p>
<p>在打开大的对象的分析的时候,发现Arraylist这个里面的东西也非常多,给他挤满了.分析出来,应该就是这2个原因.但是这样不太具体,我们可以通过线程Dump分析;</p>
<p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819153005.png" alt></p>
<p><code>看出现问题的代码,我们可以看到确实是14行出现了问题,一个往内存添加对象,导致出现OOM异常</code></p>
<h1 id="GC回收算法"><a href="#GC回收算法" class="headerlink" title="GC回收算法"></a>GC回收算法</h1><h2 id="引用计数器"><a href="#引用计数器" class="headerlink" title="引用计数器"></a>引用计数器</h2><p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819154004.png" alt></p>
<h2 id="复制算法"><a href="#复制算法" class="headerlink" title="复制算法"></a>复制算法</h2><p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819154821.png" alt></p>
<ul>
<li>好处:没有内存的碎片~</li>
<li>坏处:浪费了内存空间~:多了一半空间永远是空to。 假设对象100%存活(极端情况)</li>
<li>复制算法最佳使用场景:对象存活度较低的时候;新生区~</li>
</ul>
<h2 id="标记清除法"><a href="#标记清除法" class="headerlink" title="标记清除法"></a>标记清除法</h2><p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819160129.png" alt></p>
<ul>
<li>好处:不要额外的空间(比如复制算法的to区)</li>
<li>缺点:两次扫描,严重浪费时间,有内存碎片</li>
</ul>
<h2 id="标记压缩"><a href="#标记压缩" class="headerlink" title="标记压缩"></a>标记压缩</h2><p><img src="https://cdn.jsdelivr.net/gh/1790735465/butterfly_image/img/20200819160546.png" alt></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>内存效率:        复制算法&gt;标记清除算法&gt;标记压缩算法(时间复杂度)</li>
<li>内存整齐度:    复制算法=标记压缩算法&gt;标记清除算法</li>
<li>内存利用率:    标记压缩算法=标记清除算法&gt;复制算法</li>
</ul>
<p><strong>年轻代:</strong></p>
<ul>
<li>存活率低</li>
<li>复制算法</li>
</ul>
<p><strong>老年代</strong></p>
<ul>
<li>区域大:存活率</li>
<li>标记清除(内存碎片不是太多) +标记压缩混合实现</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">csde`Blog</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.csde.vip/posts/4235494950/">https://www.csde.vip/posts/4235494950/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.csde.vip" target="_blank">csde`Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post_share"><div class="social-share" data-image="https://dss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=1037444687,2006299490&amp;fm=111&amp;gp=0.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/1661584376/"><img class="prev_cover" src="https://dss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=3311114839,327046256&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Shell编程</div></div></a></div><div class="next-post pull_right"><a href="/posts/322094917/"><img class="next_cover" src="https://dss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1809522521,2258770536&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">POI及EasyExcel学习</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'昵称,邮箱,主页')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')
let friends = 'ce2266d4e91782573b50c29e06a811e4'.split(',')
let master = 'd799cdaab02b754cb52617372d860835'.split(',')

window.valine = new Valine({
  el:'#vcomment',
  appId: '8FuNpxJtbdHtuhJ3GKoCfTWh-gzGzoHsz',
  appKey: 'UhJiKPdHOOIQ9G7Duuj2l7br',
  notify: false,
  verify: false,
  placeholder: '请不要说脏话哦！',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-cn',
  recordIP: true,
  serverURLs: '',
  emojiCDN: '//i0.hdslb.com/bfs/emote/',
  emojiMaps: {"2020":"dc709fac0d361370bcf0d36d32adb97df7c95824.png","tv_白眼":"c1d59f439e379ee50eef488bcb5e5378e5044ea4.png","tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_坏笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_难过":"87f46748d3f142ebc6586ff58860d0e2fc8263ba.png","tv_生气":"26702dcafdab5e8225b43ffd23c94ac1ff932654.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_斜眼笑":"911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_发怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_惊吓":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","tv_呕吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_疑问":"0793d949b18d7be716078349c202c15ff166f314.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_鼓掌":"1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png","tv_抠鼻":"c666f55e88d471e51bbd9fab9bb308110824a6eb.png","tv_亲亲":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_调皮":"b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png","tv_笑哭":"1abc628f6d4f4caf9d0e7800878f4697abbc8273.png","tv_晕":"5443c22b4d07fb1907ccc610c8e6db254f2461b7.png","tv_点赞":"f85c354995bd99e28fc76c869bfe42ba6438eff4.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_睡着":"8b196675b53af58264f383c50ad0945048290b33.png","tv_色":"61822c7e9aae5da76475e7892534545336b23a6f.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_无奈":"ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png","tv_再见":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_流汗":"cead1c351ab8d79e9f369605beb90148db0fbed3.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_抓狂":"fe31c08edad661d63762b04e17b8d5ae3c71a757.png","tv_黑人问号":"45821a01f51bc867da9edbaa2e070410819a95b2.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_打脸":"56ab10b624063e966bfcb76ea5dc4794d87dfd47.png","tv_闭嘴":"c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png","tv_鄙视":"6e72339f346a692a495b123174b49e4e8e781303.png","tv_腼腆":"89712c0d4af73e67f89e35cbc518420380a7f6f4.png","tv_馋":"fc7e829b845c43c623c8b490ee3602b7f0e76a31.png","tv_可爱":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_发财":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_生病":"8b0ec90e6b86771092a498c54f09fc94621c1900.png","tv_流鼻血":"c32d39db2737f89b904ca32700d140a9241b0767.png","tv_尴尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_流泪":"7e71cde7858f0cd50d74b0264aa26db612a8a167.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_皱眉":"72ccad6679fea0d14cce648b4d818e09b8ffea2d.png","tv_鬼脸":"0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png","tv_调侃":"4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png","tv_目瞪口呆":"0b8cb81a68de5d5365212c99375e7ace3e7891b7.png","2233娘_大笑":"16b8794be990cefa6caeba4d901b934a227ee3b8.png","2233娘_疑问":"0b41f509351958dbb63d472fec0132d1bd03bd14.png","2233娘_吃惊":"d1628c43d35b1530c0504a643ff80b6189fa0a43.png","2233娘_汗":"247cd9df8cdf84b18368c21e3b2dd374e84c0927.png","2233娘_大哭":"476a2a60f6e337b8c0697a592e0aa82781f6b33b.png","2233娘_困惑":"714eeb4eae0d0933b4ff08b7df788b1982f6b940.png","2233娘_耶":"d7178e258a0efc969b65ccc2b1322fb235f5dff4.png","2233娘_怒":"f31953119c51b9748016440ac0b632f779929b37.png","2233娘_卖萌":"ea893aa25355de95ab4f03c2dad3f0c58d0c159e.png","2233娘_委屈":"d9d0bf9d358af8d5761093ec66d4e3f60d963a63.png","2233娘_郁闷":"485203fe7100f2c8fc40b2800a18fe20b35f2f1a.png","2233娘_第一":"3754ee6e5985bd0bd7dfb668981f2a8733398ebd.png","2233娘_喝水":"695bf5429472049b52c1e0de586f8a2511195a23.png","2233娘_吐魂":"e999af499edf38a91ca68b1a9d2f97042c1d6734.png","2233娘_无言":"fdb5870f32cfaf7949e0f88a13f6feba4a48b719.png","热词系列_增加":"142409b595982b8210b2958f3d340f3b47942645.png","热词系列_泪目":"bba3703ab90b7d16fe9dbcb85ed949db687f8331.png","热词系列_保护":"55f8f6445ca7c3170cdfc5b16036abf639ce9b57.png","热词系列_害怕":"d77e2de26da143249f0c0ad7a608c27152c985bf.png","热词系列_爱了爱了":"2a165b555ba20391316366c664ed7891883dc5aa.png","热词系列_问号":"c1d1e76c12180adc8558f47006fe0e7ded4154bb.png","热词系列_吹爆":"b528220f9c37256ed6a37f05bf118e44b08b81e5.png","热词系列_三连":"21f15fe11b7a84d2f2121c16dec50a4e4556f865.png","热词系列_可以":"e08543c71202b36c590094417fcfbb80c3506cd8.png","热词系列_打卡":"a9cf77c78e1b9b40aa3ed4862402fba008ee2f51.png","热词系列_妙啊":"0e98299d7decf5eaffad854977946075c3e91cb8.png","热词系列_这次一定":"a01ca28923daa7cc896c42f27deb4914e20dd572.png","热词系列_AWSL":"c37f88cf799f9badf9d84b7671dc3dd98c0fc0c2.png","热词系列_递话筒":"98e6950e39fbb4dd1c576042063ca632074070ba.png","热词系列_你细品":"535e00658e7e47966f154d3a167fa2365ebc4321.png","热词系列_咕咕":"d8065c2e7ce48c929317a94553499a46fecc262a.png","热词系列_标准结局":"3de98174b510cf7dc5fd1bd08c5d881065e79137.png","热词系列_危":"5cc6c3357c4df544dd8de9d5c5c0cec97c7c9a56.png","热词系列_张三":"255a938f39cea625032b6650036b31aa26c50a3c.png","热词系列_害":"cbe798a194612958537c5282fcca7c3bcd2aa15c.png","热词系列_我裂开了":"29bd57ec4e8952880fea6c9e47aee924e91f10c4.png","热词系列_有内味了":"7ca61680a905b5b6e2e335c630e725b648b03b4d.png","热词系列_猛男必看":"c97064450528a0e45c7e7c365a15fbb13fd61d8c.png","热词系列_奥力给":"c9b8683827ec6c00fea5327c9bec14f581cef2aa.png","热词系列_我哭了":"9e0b3877d649aaf6538fbdd3f937e240a9d808e4.png","热词系列_高产":"9db817cba4a7f4a42398f3b2ec7c0a8e0c247c42.png","热词系列_我酸了":"a8cbf3f6b8cd9377eeb15b9172f3cd683b2e4650.png","热词系列_真香":"e68497c775feaac1c3b1a6cd63a50cfb11b767c4.png","热词系列_我全都要":"d424d1ad8d14c1c9b8367842bc68c658b9229bc1.png","热词系列_神仙UP":"a49e0d0db1e7d35a0f7411be13208951ab448f03.png","热词系列_你币有了":"84820c2b147a8ca02f3c4006b63f76c6313cbfa0.png","热词系列_不愧是你":"9ff2e356797c57ee3b1675ade0883d2d2247be9b.png","热词系列_锤":"35668cc12ae25b9545420e4a85bf21a0bfc03e5d.png","热词系列_秀":"50782fbf5d9b7f48f9467b5c53932981e321eedc.png","热词系列_爷关更":"faad40c56447f1f8abcb4045c17ce159d113d1fd.png","热词系列_有生之年":"f41fdafe2d0fbb8e8bc1598d2cf37e355560103a.png","热词系列_镇站之宝":"24e7a6a6e6383c987215fb905e3ee070aca259b5.png","热词系列_我太男了":"a523f3e4c63e4db1232365765d0ec452f83be97e.png","热词系列_完结撒花":"ea9db62ff5bca8e069cd70c4233353a802835422.png","热词系列_大师球":"f30089248dd137c568edabcb07cf67e0f6e98cf3.png","热词系列_知识盲区":"ccc94600b321a28116081e49ecedaa4ee8728312.png","热词系列_“狼火”":"33ccd3617bfa89e9d1498b13b7542b63f163e5de.png","加油武汉":"eb966aaa5b690d3f9308a9f936f5b5a72a7f956b.png","口罩":"3ad2f66b151496d2a5fb0a8ea75f32265d778dd3.png","鸡腿":"c7860392815d345fa69c4f00ef18d67dccfbd574.png","微笑":"685612eadc33f6bc233776c6241813385844f182.png","笑":"81edf17314cea3b48674312b4364df44d5c01f17.png","呲牙":"b5a5898491944a4268360f2e7a84623149672eb6.png","OK":"4683fd9ffc925fa6423110979d7dcac5eda297f4.png","星星眼":"63c9d1a31c0da745b61cdb35e0ecb28635675db2.png","哦呼":"362bded07ea5434886271d23fa25f5d85d8af06c.png","嫌弃":"de4c0783aaa60ec03de0a2b90858927bfad7154b.png","喜欢":"8a10a4d73a89f665feff3d46ca56e83dc68f9eb8.png","酸了":"92b1c8cbceea3ae0e8e32253ea414783e8ba7806.png","大哭":"2caafee2e5db4db72104650d87810cc2c123fc86.png","害羞":"9d2ec4e1fbd6cb1b4d12d2bbbdd124ccb83ddfda.png","无语":"44667b7d9349957e903b1b62cb91fb9b13720f04.png","疑惑":"b7840db4b1f9f4726b7cb23c0972720c1698d661.png","调皮":"8290b7308325e3179d2154327c85640af1528617.png","喜极而泣":"485a7e0c01c2d70707daae53bee4a9e2e31ef1ed.png","奸笑":"bb84906573472f0a84cebad1e9000eb6164a6f5a.png","偷笑":"6c49d226e76c42cd8002abc47b3112bc5a92f66a.png","大笑":"ca94ad1c7e6dac895eb5b33b7836b634c614d1c0.png","阴险":"ba8d5f8e7d136d59aab52c40fd3b8a43419eb03c.png","捂脸":"6921bb43f0c634870b92f4a8ad41dada94a5296d.png","囧":"12e41d357a9807cc80ef1e1ed258127fcc791424.png","呆":"33ad6000d9f9f168a0976bc60937786f239e5d8c.png","抠鼻":"cb89184c97e3f6d50acfd7961c313ce50360d70f.png","惊喜":"0afecaf3a3499479af946f29749e1a6c285b6f65.png","惊讶":"f8e9a59cad52ae1a19622805696a35f0a0d853f3.png","笑哭":"c3043ba94babf824dea03ce500d0e73763bf4f40.png","妙啊":"b4cb77159d58614a9b787b91b1cd22a81f383535.png","doge":"bba7c12aa51fed0199c241465560dfc2714c593e.png","滑稽":"d15121545a99ac46774f1f4465b895fe2d1411c3.png","吃瓜":"4191ce3c44c2b3df8fd97c33f85d3ab15f4f3c84.png","打call":"431432c43da3ee5aab5b0e4f8931953e649e9975.png","点赞":"1a67265993913f4c35d15a6028a30724e83e7d35.png","鼓掌":"895d1fc616b4b6c830cf96012880818c0e1de00d.png","尴尬":"cb321684ed5ce6eacdc2699092ab8fe7679e4fda.png","冷":"cb0ebbd0668640f07ebfc0e03f7a18a8cd00b4ed.png","灵魂出窍":"43d3db7d97343c01b47e22cfabeca84b4251f35a.png","委屈":"d2f26cbdd6c96960320af03f5514c5b524990840.png","傲娇":"010540d0f61220a0db4922e4a679a1d8eca94f4e.png","疼":"905fd9a99ec316e353b9bd4ecd49a5f0a301eabf.png","吓":"9c10c5ebc7bef27ec641b8a1877674e0c65fea5d.png","生病":"0f25ce04ae1d7baf98650986454c634f6612cb76.png","吐":"06946bfe71ac48a6078a0b662181bb5cad09decc.png","嘘声":"e64af664d20716e090f10411496998095f62f844.png","捂眼":"c5c6d6982e1e53e478daae554b239f2b227b172b.png","思考":"cfa9b7e89e4bfe04bbcd34ccb1b0df37f4fa905c.png","再见":"fc510306bae26c9aec7e287cdf201ded27b065b9.png","翻白眼":"eba54707c7168925b18f6f8b1f48d532fe08c2b1.png","哈欠":"888d877729cbec444ddbd1cf4c9af155a7a06086.png","奋斗":"bb2060c15dba7d3fd731c35079d1617f1afe3376.png","墨镜":"3a03aebfc06339d86a68c2d893303b46f4b85771.png","撇嘴":"531863568e5668c5ac181d395508a0eeb1f0cda4.png","难过":"a651db36701610aa70a781fa98c07c9789b11543.png","抓狂":"4c87afff88c22439c45b79e9d2035d21d5622eba.png","生气":"3195714219c4b582a4fb02033dd1519913d0246d.png","干杯":"8da12d5f55a2c7e9778dcc05b40571979fe208e6.png","爱心":"ed04066ea7124106d17ffcaf75600700e5442f5c.png","锦鲤":"643d6c19c8164ffd89e3e9cdf093cf5d773d979c.png","胜利":"b49fa9f4b1e7c3477918153b82c60b114d87347c.png","加油":"c7aaeacb21e107292d3bb053e5abde4a4459ed30.png","保佑":"fafe8d3de0dc139ebe995491d2dac458a865fb30.png","抱拳":"89516218158dbea18ab78e8873060bf95d33bbbe.png","响指":"1b5c53cf14336903e1d2ae3527ca380a1256a077.png","支持":"3c210366a5585706c09d4c686a9d942b39feeb50.png","拥抱":"41780a4254750cdaaccb20735730a36044e98ef3.png","怪我咯":"07cc6077f7f7d75b8d2c722dd9d9828a9fb9e46d.png","跪了":"f2b3aee7e521de7799d4e3aa379b01be032698ac.png","黑洞":"e90ec4c799010f25391179118ccd9f66b3b279ba.png","老鼠":"8e6fb491eb1bb0d5862e7ec8ccf9a3da12b6c155.png","福到了":"5de5373d354c373cf1617b6b836f3a8d53c5a655.png"},
  enableQQ: true,
  requiredFields: requiredFields,
  master: master,
  friends: friends,
  metaPlaceholder: {"nick":"昵称/QQ号(必填)","mail":"邮箱(必填)","link":"网址(https://)"}
});</script></div></article></main><footer id="footer" style="background-image: url(https://dss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1818586636,1891100743&amp;fm=26&amp;gp=0.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By csde`Blog</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/gh/1790735465/static/js/title.js"></script></body></html>